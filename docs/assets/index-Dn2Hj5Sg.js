var _t=Object.defineProperty;var wt=(P,I,D)=>I in P?_t(P,I,{enumerable:!0,configurable:!0,writable:!0,value:D}):P[I]=D;var U=(P,I,D)=>(wt(P,typeof I!="symbol"?I+"":I,D),D);(async()=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();const P=""+new URL("snake-CdNeR5QQ.wasm",import.meta.url).href;var I=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function D(){var t=new I(16);return I!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function v5(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function L5(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function k5(t,e){if(t===e){var r=e[1],i=e[2],n=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=a,t[11]=e[14],t[12]=n,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function O5(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],m=e[7],f=e[8],u=e[9],c=e[10],_=e[11],E=e[12],y=e[13],T=e[14],M=e[15],S=r*s-i*o,v=r*l-n*o,p=r*m-a*o,d=i*l-n*s,g=i*m-a*s,b=n*m-a*l,X=f*y-u*E,W=f*T-c*E,k=f*M-_*E,$=u*T-c*y,O=u*M-_*y,q=c*M-_*T,x=S*q-v*O+p*$+d*k-g*W+b*X;return x?(x=1/x,t[0]=(s*q-l*O+m*$)*x,t[1]=(n*O-i*q-a*$)*x,t[2]=(y*b-T*g+M*d)*x,t[3]=(c*g-u*b-_*d)*x,t[4]=(l*k-o*q-m*W)*x,t[5]=(r*q-n*k+a*W)*x,t[6]=(T*p-E*b-M*v)*x,t[7]=(f*b-c*p+_*v)*x,t[8]=(o*O-s*k+m*X)*x,t[9]=(i*k-r*O-a*X)*x,t[10]=(E*g-y*p+M*S)*x,t[11]=(u*p-f*g-_*S)*x,t[12]=(s*W-o*$-l*X)*x,t[13]=(r*$-i*W+n*X)*x,t[14]=(y*v-E*d-T*S)*x,t[15]=(f*d-u*v+c*S)*x,t):null}function P5(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],s=e[4],l=e[5],m=e[6],f=e[7],u=e[8],c=e[9],_=e[10],E=e[11],y=e[12],T=e[13],M=e[14],S=e[15],v=r[0],p=r[1],d=r[2],g=r[3];return t[0]=v*i+p*s+d*u+g*y,t[1]=v*n+p*l+d*c+g*T,t[2]=v*a+p*m+d*_+g*M,t[3]=v*o+p*f+d*E+g*S,v=r[4],p=r[5],d=r[6],g=r[7],t[4]=v*i+p*s+d*u+g*y,t[5]=v*n+p*l+d*c+g*T,t[6]=v*a+p*m+d*_+g*M,t[7]=v*o+p*f+d*E+g*S,v=r[8],p=r[9],d=r[10],g=r[11],t[8]=v*i+p*s+d*u+g*y,t[9]=v*n+p*l+d*c+g*T,t[10]=v*a+p*m+d*_+g*M,t[11]=v*o+p*f+d*E+g*S,v=r[12],p=r[13],d=r[14],g=r[15],t[12]=v*i+p*s+d*u+g*y,t[13]=v*n+p*l+d*c+g*T,t[14]=v*a+p*m+d*_+g*M,t[15]=v*o+p*f+d*E+g*S,t}function C5(t,e,r){var i=r[0],n=r[1],a=r[2],o,s,l,m,f,u,c,_,E,y,T,M;return e===t?(t[12]=e[0]*i+e[4]*n+e[8]*a+e[12],t[13]=e[1]*i+e[5]*n+e[9]*a+e[13],t[14]=e[2]*i+e[6]*n+e[10]*a+e[14],t[15]=e[3]*i+e[7]*n+e[11]*a+e[15]):(o=e[0],s=e[1],l=e[2],m=e[3],f=e[4],u=e[5],c=e[6],_=e[7],E=e[8],y=e[9],T=e[10],M=e[11],t[0]=o,t[1]=s,t[2]=l,t[3]=m,t[4]=f,t[5]=u,t[6]=c,t[7]=_,t[8]=E,t[9]=y,t[10]=T,t[11]=M,t[12]=o*i+f*n+E*a+e[12],t[13]=s*i+u*n+y*a+e[13],t[14]=l*i+c*n+T*a+e[14],t[15]=m*i+_*n+M*a+e[15]),t}function F5(t,e,r){var i=r[0],n=r[1],a=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function B5(t,e,r){var i=Math.sin(r),n=Math.cos(r),a=e[4],o=e[5],s=e[6],l=e[7],m=e[8],f=e[9],u=e[10],c=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*n+m*i,t[5]=o*n+f*i,t[6]=s*n+u*i,t[7]=l*n+c*i,t[8]=m*n-a*i,t[9]=f*n-o*i,t[10]=u*n-s*i,t[11]=c*n-l*i,t}function V5(t,e,r){var i=Math.sin(r),n=Math.cos(r),a=e[0],o=e[1],s=e[2],l=e[3],m=e[8],f=e[9],u=e[10],c=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*n-m*i,t[1]=o*n-f*i,t[2]=s*n-u*i,t[3]=l*n-c*i,t[8]=a*i+m*n,t[9]=o*i+f*n,t[10]=s*i+u*n,t[11]=l*i+c*n,t}function X5(t,e,r){var i=Math.sin(r),n=Math.cos(r),a=e[0],o=e[1],s=e[2],l=e[3],m=e[4],f=e[5],u=e[6],c=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*n+m*i,t[1]=o*n+f*i,t[2]=s*n+u*i,t[3]=l*n+c*i,t[4]=m*n-a*i,t[5]=f*n-o*i,t[6]=u*n-s*i,t[7]=c*n-l*i,t}var W5=P5;function $5(){var t=new I(3);return I!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function c5(t,e,r){var i=new I(3);return i[0]=t,i[1]=e,i[2]=r,i}function l5(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}(function(){var t=$5();return function(e,r,i,n,a,o){var s,l;for(r||(r=3),i||(i=0),n?l=Math.min(n*r+i,e.length):l=e.length,s=i;s<l;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}})();for(var C=256,g5=[],_5=256,Z;C--;)g5[C]=(C+256).toString(16).substring(1);function G5(t){var e=0,r=t||11;if(!Z||C+r>_5*2)for(Z="",C=0;e<_5;e++)Z+=g5[Math.random()*256|0];return Z.substring(C,C+++r)}var J={},Y5=function(){function t(e,r,i,n){this.x=e,this.y=r,this.w=i,this.h=n}return t.prototype.fitsIn=function(e){return e.w>=this.w&&e.h>=this.h},t.prototype.sameSizeAs=function(e){return this.w===e.w&&this.h===e.h},t}();Object.defineProperty(J,"__esModule",{value:!0}),J.default=Y5;var t5={},d5=J;function w5(t){var e=t.width/2,r=document.createElement("canvas");r.id=t.id||"",r.width=t.width+t.width,r.height=t.height+t.height;var i=r.getContext("2d"),n=i.createPattern(t,"repeat");return i.fillStyle=n,i.translate(e,e),i.fillRect(-e,-e,r.width+e,r.height+e),i.translate(-e,-e),r}function E5(t,e,r,i){var n=e?t.rect.w/4:0;return[[t.rect.x+n,t.rect.y+n],[t.rect.x+n+(t.rect.w-n*2),t.rect.y+n],[t.rect.x+n+(t.rect.w-n*2),t.rect.y+n+(t.rect.h-n*2)],[t.rect.x+n,t.rect.y+n+(t.rect.h-n*2)]].map(function(a){return a[0]!==0&&(a[0]=a[0]/r),a[1]!==0&&(a[1]=a[1]/i),a})}function x5(t,e,r,i){var n=e?t.rect.w/4:0,a=new Float32Array(8);return a[0]=(t.rect.x+n)/r,a[1]=(t.rect.y+n)/i,a[2]=(t.rect.x+n+(t.rect.w-n*2))/r,a[3]=(t.rect.y+n)/i,a[4]=(t.rect.x+n+(t.rect.w-n*2))/r,a[5]=(t.rect.y+n+(t.rect.h-n*2))/i,a[6]=(t.rect.x+n)/r,a[7]=(t.rect.y+n+(t.rect.h-n*2))/i,a}var z=function(){function t(e,r,i,n){this.left=this.right=null,this.rect=new d5.default(e,r,i,n),this.filled=!1}return t.prototype.pack=function(e){return this.left!==null?this.left.pack(e)||this.right.pack(e):this.filled||!e.fitsIn(this.rect)?null:e.sameSizeAs(this.rect)?(this.filled=!0,this):(this.rect.w-e.w>this.rect.h-e.h?(this.left=new t(this.rect.x,this.rect.y,e.w,this.rect.h),this.right=new t(this.rect.x+e.w,this.rect.y,this.rect.w-e.w,this.rect.h)):(this.left=new t(this.rect.x,this.rect.y,this.rect.w,e.h),this.right=new t(this.rect.x,this.rect.y+e.h,this.rect.w,this.rect.h-e.h)),this.left.pack(e))},t}();t5.AtlasNode=z;var j5=function(){function t(e,r){r===void 0&&(r={}),this.tilepad=r.tilepad||!1,this.canvas=e,this.context=e.getContext("2d"),this._rootNode=new z(0,0,this.canvas.width,this.canvas.height),this._terminalNodes={},this.invalidateUvIndices()}return t.prototype.pack=function(e,r){return this._checkId(e),this._pack(e,this.tilepad?w5(r):r)},t.prototype.expand=function(e,r){return this._checkId(e),this.invalidateUvIndices(),this._expand(e,this.tilepad?w5(r):r)},t.prototype.index=function(){var e=this;return Object.keys(this._terminalNodes).map(function(r){return e._terminalNodes[r].rect})},t.prototype.uv=function(){return this._uvs?this._uvs:(this._uvs=this.buildUvIndex(),this._uvs)},t.prototype.uv2=function(){return this._uvs2?this._uvs2:(this._uvs2=this.buildUvIndex2(),this._uvs2)},t.prototype.invalidateUvIndices=function(){this._uvs=null,this._uvs2=null},t.prototype._checkId=function(e){if(this._terminalNodes[e])throw new Error("Duplicated texture id "+e)},t.prototype._pack=function(e,r){var i=new d5.default(0,0,r.width,r.height),n=this._rootNode.pack(i);return n?(this._ontoCanvas(e,r,n.rect),this._terminalNodes[e]=n,this._uvs&&(this._uvs[e]=E5(n,this.tilepad,this.canvas.width,this.canvas.height)),this._uvs2&&(this._uvs2[e]=x5(n,this.tilepad,this.canvas.width,this.canvas.height)),n):null},t.prototype._expand=function(e,r){var i=new d5.default(0,0,r.width,r.height),n=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),a;this._rootNode.rect.w<this._rootNode.rect.h?(this.canvas.width=this._rootNode.rect.w+i.w,a=new z(this._rootNode.rect.w,0,i.w,this._rootNode.rect.h)):(this.canvas.height=this._rootNode.rect.h+i.h,a=new z(0,this._rootNode.rect.h,this._rootNode.rect.w,i.h)),this.context.putImageData(n,0,0);var o=this._rootNode;return this._rootNode=new z(0,0,this.canvas.width,this.canvas.height),this._rootNode.left=o,this._rootNode.right=a,this._pack(e,r)?this:this._expand(e,r)},t.prototype.buildUvIndex=function(){var e=this,r={};return Object.keys(this._terminalNodes).map(function(i){var n=e._terminalNodes[i];r[i]=E5(n,e.tilepad,e.canvas.width,e.canvas.height)}),r},t.prototype.buildUvIndex2=function(){var e=this,r={};return Object.keys(this._terminalNodes).map(function(i){var n=e._terminalNodes[i];r[i]=x5(n,e.tilepad,e.canvas.width,e.canvas.height)}),r},t.prototype._ontoCanvas=function(e,r,i){this.context.clearRect(i.x,i.y,i.w,i.h),this.context.drawImage(r,i.x,i.y,i.w,i.h)},t}();Object.defineProperty(t5,"__esModule",{value:!0}),t5.default=j5;var z5=J;z5.default;var H5=t5,K5=H5.default,Q5=Object.defineProperty,q5=(t,e,r)=>e in t?Q5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,F=(t,e,r)=>(q5(t,typeof e!="symbol"?e+"":e,r),r),y5=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},A=(t,e,r)=>(y5(t,e,"read from private field"),r?r.call(t):e.get(t)),e5=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},Z5=(t,e,r,i)=>(y5(t,e,"write to private field"),i?i.call(t,r):e.set(t,r),r),u5="-- DEFINES_HOOK --",J5=(t,e,r,i={})=>{if(Object.keys(i).length&&!r.includes(u5))throw new Error(`in order to include defines, you must provide "${u5}" in your shader code`);let n="";for(const[s,l]of Object.entries(i)){if(typeof l=="boolean"&&!l)continue;let m=`${l}`;typeof l=="number"&&Number.isInteger(l)&&(m+=".0"),n+=`#define ${s} ${m}
`}r=r.replace(u5,n);const a=t.createShader(e);if(t.shaderSource(a,r),t.compileShader(a),t.getShaderParameter(a,t.COMPILE_STATUS))return a;const o=`
    Error in ${e===t.VERTEX_SHADER?"Vertex":"Fragment"} shader:
    ${t.getShaderInfoLog(a)}
  `;throw t.deleteShader(a),new Error(o)},T5=J5,tt=(t,e,r,i)=>{const n=T5(t,t.VERTEX_SHADER,e,i),a=T5(t,t.FRAGMENT_SHADER,r,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,a),t.linkProgram(o),t.detachShader(o,n),t.deleteShader(n),t.detachShader(o,a),t.deleteShader(a),t.getProgramParameter(o,t.LINK_STATUS))return o;const s=new Error(`Error linking program: ${t.getProgramInfoLog(o)}`);throw t.deleteProgram(o),s},M5=tt,et=(t,e,r,i)=>{let n;switch(e){case t.FLOAT:return t.uniform1f(r,i);case t.FLOAT_VEC2:return n=i,t.uniform2f(r,n[0],n[1]);case t.FLOAT_VEC3:return n=i,t.uniform3f(r,n[0],n[1],n[2]);case t.FLOAT_VEC4:return n=i,t.uniform4f(r,n[0],n[1],n[2],n[3]);case t.BOOL:case t.INT:case t.SAMPLER_2D:case t.SAMPLER_CUBE:return t.uniform1i(r,i);case t.BOOL_VEC2:case t.INT_VEC2:return n=i,t.uniform2i(r,n[0],n[1]);case t.BOOL_VEC3:case t.INT_VEC3:return n=i,t.uniform3i(r,n[0],n[1],n[2]);case t.BOOL_VEC4:case t.INT_VEC4:return n=i,t.uniform4i(r,n[0],n[1],n[2],n[3]);case t.FLOAT_MAT2:return t.uniformMatrix2fv(r,!1,i);case t.FLOAT_MAT3:return t.uniformMatrix3fv(r,!1,i);case t.FLOAT_MAT4:return t.uniformMatrix4fv(r,!1,i);default:throw new Error("wrong type for uniform")}},A5=et,rt=(t={})=>{const{width:e=1,height:r=1,widthSegments:i=1,heightSegments:n=1,flipUVy:a=!1}=t,o=i,s=n,l=(o+1)*(s+1),m=o*s*6,f=new Float32Array(l*3+l*2),u=l>65536?new Uint32Array(m):new Uint16Array(m);let c=0,_=0;const E=c,y=e/o,T=r/s,M=1,S=-1,v=0,p=5;for(let d=0;d<=s;d++){const g=d*T-r/2;for(let b=0;b<=o;b++,c++){const X=b*y-e/2;if(f[c*p+0]=X*M,f[c*p+1]=g*S,f[c*p+2]=v/2,f[c*p+3]=b/o,f[c*p+4]=a?1-d/s:d/s,d===s||b===o)continue;const W=E+b+d*(o+1),k=E+b+(d+1)*(o+1),$=E+b+(d+1)*(o+1)+1,O=E+b+d*(o+1)+1;u[_*6]=W,u[_*6+1]=k,u[_*6+2]=O,u[_*6+3]=k,u[_*6+4]=$,u[_*6+5]=O,_++}}return{width:e,height:r,vertexCount:u.length,vertexStride:p,interleavedArray:f,indicesArray:u}},it=rt,nt=class{constructor(){U(this,"position",c5(0,0,0));U(this,"rotation",c5(0,0,0));U(this,"scale",c5(1,1,1));U(this,"modelMatrix",D());U(this,"shouldUpdate",!0)}copyFromMatrix(t){return v5(this.modelMatrix,t),this.shouldUpdate=!1,this}setPosition(t){return l5(this.position,t),this.shouldUpdate=!0,this}setScale(t){return l5(this.scale,t),this.shouldUpdate=!0,this}setRotation(t){return l5(this.rotation,t),this.shouldUpdate=!0,this}updateModelMatrix(){return L5(this.modelMatrix),C5(this.modelMatrix,this.modelMatrix,this.position),B5(this.modelMatrix,this.modelMatrix,this.rotation[0]),V5(this.modelMatrix,this.modelMatrix,this.rotation[1]),X5(this.modelMatrix,this.modelMatrix,this.rotation[2]),F5(this.modelMatrix,this.modelMatrix,this.scale),this.shouldUpdate=!1,this}},at=class extends nt{constructor(e=void 0){super();U(this,"parentNode",null);U(this,"_children",[]);U(this,"_visible",!0);U(this,"worldMatrix",D());U(this,"normalMatrix",D());U(this,"uid",G5(9));U(this,"name");this.name=e}get visible(){return this._visible}set visible(e){this._visible=e}get children(){return this._children}get siblings(){return this.parentNode?this.parentNode._children:[]}get levelIndex(){let e=0,r=this.parentNode;for(;r;)e++,r=r.parentNode;return e}setParent(e=null){if(this.parentNode){const r=this.parentNode._children.indexOf(this);r>=0&&this.parentNode._children.splice(r,1)}return e&&e.addChild(this),this.parentNode=e,this}addChild(e){return this._children.push(e),this}updateWorldMatrix(e=null){this.shouldUpdate&&this.updateModelMatrix(),e?W5(this.worldMatrix,e,this.modelMatrix):v5(this.worldMatrix,this.modelMatrix),O5(this.normalMatrix,this.worldMatrix),k5(this.normalMatrix,this.normalMatrix);for(let r=0;r<this._children.length;r++)this._children[r].updateWorldMatrix(this.worldMatrix);return this}traverse(e,r=0){e(this,r),r++;for(let i=0;i<this._children.length;i++)this._children[i].traverse(e,r)}findChild(e){if(e(this))return this;let r=null;for(let i=0;i<this._children.length&&!(r=this._children[i].findChild(e));i++);return r}findChildByName(e){if(this.name===e)return this;let r=null;for(let i=0;i<this._children.length&&!(r=this._children[i].findChildByName(e));i++);return r}findParent(e){if(e(this))return this;let r=null,i=this.parentNode;for(;i&&!(r=i.findParent(e));)i=i==null?void 0:i.parentNode;return r}findParentByName(e){if(this.name===e)return this;let r=null,i=this.parentNode;for(;i&&!(r=i.findParentByName(e));)i=i==null?void 0:i.parentNode;return r}render(){if(this._visible)for(let e=0;e<this._children.length;e++)this._children[e].render()}},G,r5=class extends at{constructor(t,e,r,i={},n){if(super(n),F(this,"gl"),F(this,"vao"),F(this,"vertexCount"),e5(this,G,new Map),F(this,"boundingBox"),F(this,"program"),this.gl=t,this.vao=t.createVertexArray(),this.program=M5(t,e,r,i),this.program.__SPECTOR_Metadata={name:n,shaderDefines:i},!this.setUniform(r5.WORLD_MATRIX_UNIFORM_NAME,{type:t.FLOAT_MAT4}))throw new Error(`Each Drawable is expected to have a mat4 ${r5.WORLD_MATRIX_UNIFORM_NAME} implemented in shader`)}setUniform(t,{type:e,value:r}){const i=this.gl;let n;if(n=A(this,G).get(t))n.value=r;else{const a=i.getUniformLocation(this.program,t);if(!a)return console.error(`uniform with name ${t} was not found in the program`),!1;n={type:e,location:a,value:r},A(this,G).set(t,n)}return r!=null&&(i.useProgram(this.program),A5(i,n.type,n.location,r)),!0}updateUniform(t,e){let r;if(r=this.getUniform(t)){r.value=e;const i=this.gl;return i.useProgram(this.program),A5(i,r.type,r.location,e),!0}return!1}getUniform(t){let e;return(e=A(this,G).get(t))?e:(console.error("can't locate uniform with that name"),null)}updateWorldMatrix(t){return super.updateWorldMatrix(t),this.updateUniform(r5.WORLD_MATRIX_UNIFORM_NAME,this.worldMatrix),this}destroy(){A(this,G).clear();const t=this.gl;t.deleteVertexArray(this.vao),t.deleteProgram(this.program)}},ot=r5;G=new WeakMap,F(ot,"WORLD_MATRIX_UNIFORM_NAME","u_worldMatrix");var st=document.createElement("canvas"),N5=st.getContext("webgl2"),L=N5.MAX_TEXTURE_SIZE,i5=N5.RGB,f5,w,m5=!1,B,Y,j,p5=class{constructor(){if(e5(this,B,[]),e5(this,Y,[]),e5(this,j,document.createElement("div")),m5){const t=document.createElement("style"),e="hwoa-rang-texture-atlas-debug";t.setAttribute("type","text/css");const r=`
        #${e} {
          position: fixed;
          bottom: 1rem;
          right: 1rem;
          transform-origin: 100% 100%;
          width: 400px;
          max-height: 100vh;
          overflow: scroll;
        }
        #${e} canvas {
          max-width: 100%;
        }
      `;t.appendChild(document.createTextNode(r)),document.getElementsByTagName("head")[0].appendChild(t),Z5(this,j,document.createElement("div")),A(this,j).setAttribute("id",e),document.body.appendChild(A(this,j))}}static set debugMode(t){m5=t}static get textureSize(){return L}static set textureSize(t){L=t}static set textureFormat(t){i5=t}static set gl(t){w=t}static getInstance(){if(!w)throw new Error("You must provide a WebGL2RenderingContext first via setting the TextureAtlas.gl property!");return f5||(f5=new p5),f5}pack(t,e,r=1){const i=()=>{const c=document.createElement("canvas");A(this,j).appendChild(c),c.width=L,c.height=L;const _=w.createTexture();w.bindTexture(w.TEXTURE_2D,_),w.texParameterf(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.LINEAR_MIPMAP_LINEAR),w.texImage2D(w.TEXTURE_2D,0,i5,L,L,0,i5,w.UNSIGNED_BYTE,null),w.generateMipmap(w.TEXTURE_2D),w.bindTexture(w.TEXTURE_2D,null);const E=new K5(c);return A(this,B).push(E),A(this,Y).push(_),E};let n=A(this,B)[A(this,B).length-1];n||(n=i());const a=r===1?e:p5.scaleDownDrawableByFactor(e,r);n.pack(t,a)||(n=i(),n.pack(t,a));const o=n.uv()[t];for(let c=0;c<o.length;c++)o[c][0]*=L,o[c][1]*=L;const s=A(this,Y)[A(this,Y).length-1],l=o[0][0],m=o[0][1],f=o[2][0]-o[0][0],u=o[2][1]-o[0][1];return w.bindTexture(w.TEXTURE_2D,s),w.texSubImage2D(w.TEXTURE_2D,0,l,m,f,u,i5,w.UNSIGNED_BYTE,a),w.generateMipmap(w.TEXTURE_2D),w.bindTexture(w.TEXTURE_2D,null),this}getUv2(t){let e=-1;for(let r=0;r<A(this,B).length;r++){const i=A(this,B)[r].uv2()[t];if(i){e=r;const n=A(this,Y)[e];return[i,n]}}throw new Error("Can't get uvs")}},ht=p5;B=new WeakMap,Y=new WeakMap,j=new WeakMap,F(ht,"scaleDownDrawableByFactor",(t,e)=>{const r=document.createElement("canvas"),i=t instanceof HTMLImageElement?t.naturalWidth:t.width,n=t instanceof HTMLImageElement?t.naturalHeight:t.height;r.width=i/e,r.height=n/e,m5&&console.log(`Scaled ${i}x${n} project image to ${r.width}x${r.height}`);const a=r.getContext("2d");return a.imageSmoothingQuality="high",a.drawImage(t,0,0,i,n,0,0,r.width,r.height),r});const b5=[[0,0,0,0,0,0,0,0,0,0,255,255,255,255,0,0,0,255,255,0,255,255,255,0,255,255,255,0,0,255,255,255,255,255,255,0,0,255,255,255,255,255,255,0,0,255,255,255,0,255,255,255,0,255,255,0,0,0,255,255,255,255,0,0],[0,0,0,0,0,0,0,0,0,0,0,255,255,255,0,0,0,0,255,255,255,255,0,0,0,0,0,255,255,255,0,0,0,0,0,255,255,255,0,0,0,0,0,255,255,255,0,0,0,0,0,255,255,255,0,0,0,255,255,255,255,255,255,255],[0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,255,255,255,0,0,255,255,255,0,0,0,0,255,255,255,255,0,0,255,255,255,255,255,0,0,255,255,255,255,255,0,0,255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255],[0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,0,0,0,0,255,255,255,0,0,0,0,255,255,255,0,0,0,0,255,255,255,255,255,0,0,0,0,0,0,255,255,255,255,255,255,0,0,255,255,255,0,255,255,255,255,255,255,0],[0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,0,0,0,255,255,255,255,255,0,0,255,255,255,255,255,255,0,255,255,255,0,255,255,255,0,255,255,255,255,255,255,255,255,0,0,0,0,255,255,255,0,0,0,0,0,255,255,255,0],[0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,0,255,255,255,0,0,0,0,0,255,255,255,255,255,255,255,0,0,0,0,0,0,255,255,255,0,0,0,0,0,255,255,255,255,255,255,0,0,255,255,255,0,255,255,255,255,255,255,0],[0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,0,0,255,255,255,0,0,0,0,255,255,255,0,0,0,0,0,255,255,255,255,255,255,255,0,255,255,255,0,0,255,255,255,255,255,255,0,0,255,255,255,0,255,255,255,255,255,255,0],[0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,0,0,255,255,255,0,0,0,0,255,255,255,0,0,0,0,255,255,255,0,0,0,0,255,255,255,0,0,0,0,0,255,255,255,0,0,0,0,0,255,255,255,0,0,0],[0,0,0,0,0,0,0,0,0,255,255,255,255,255,0,0,255,255,255,0,0,255,255,0,255,255,255,255,0,255,255,0,0,255,255,255,255,255,0,0,255,255,0,255,255,255,255,255,255,255,0,0,0,255,255,255,0,255,255,255,255,255,255,0],[0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,255,255,255,0,0,255,255,255,255,255,255,0,0,255,255,255,0,255,255,255,255,255,255,255,0,0,0,0,0,255,255,255,0,0,0,0,255,255,255,0,0,255,255,255,255,255,0,0],[0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,255,255,255,0,0,0,0,255,255,255,0,0,0,0,0,255,255,255,0,255,255,255,255,255,255,255,0,0,255,255,255,0,255,255,255,0,255,255,255,0,0,255,255,255,255,255,255],[0,0,0,0,0,0,0,0,0,0,255,255,255,255,0,0,0,255,255,255,255,255,255,0,255,255,255,0,0,255,255,255,255,255,255,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,255,255,255,255,255,255,0,0,255,255,255],[0,0,0,0,0,0,0,0,255,255,255,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,255,255,255,255,255,255,0,0,255,255,255],[0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,255,255,255,0,0,0,0,0,255,255,255,255,255,255,255,0,255,255,255,0,0,0,0,0,255,255,255,0,0,0,0,0,255,255,255,255,255,255,255,255],[0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,255,255,255,0,0,255,255,255,255,255,255,0,0,255,255,255,255,255,255,0,0,255,255,255,255,255,255,0,0,255,255,255,255,255,255,0,0,255,255,255,0,255,255,255,255,255,255,0],[0,0,0,0,0,0,0,0,255,255,255,0,0,255,255,255,255,255,255,0,0,255,255,255,255,255,255,0,0,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,0,0,0,255,255,255,255,0,0,0,0,0,255,255,0,0,0],[0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,255,255,255,0,0,0,0,0,255,255,255,255,255,255,255,0,255,255,255,0,0,0,0,0,255,255,255,0,0,0,0,0,255,255,255,255,255,255,255,255],[0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,0,255,255,255,0,0,255,255,255,255,255,255,0,0,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,0,0,255,255,255,255,255,255,255,0,255,255,255,0,255,255,255,255]],n5=256,a5=144,ct=20,R5=10,lt=5;let V,N=1,H=!0;const I5=document.getElementById("mobile-arrow-buttons"),dt=document.getElementById("gl-container"),K=document.createElement("canvas"),h=K.getContext("webgl2");K.width=n5,K.height=a5,K.setAttribute("id","c"),dt.appendChild(K);const{module:Et,instance:U5}=await WebAssembly.instantiateStreaming(fetch(P),{game:{onGameOver:()=>{const t=document.getElementById("refresh-icon");t.classList.add("rotate"),t.addEventListener("transitionend",()=>{setTimeout(()=>{t.classList.remove("rotate")},200)})}}});console.log(U5.exports);const R=U5.exports,ut=new Int32Array(R.memory.buffer);for(let t=0;t<b5.length;t++)for(let e=0;e<64;e++)R.setCharDataAtIdx(t*64+e,b5[t][e]);function ft(t=BigInt(Math.floor(Math.random()*2**53))){R.randomState.value=0n,R.randomInt32(),R.randomState.value+=t,R.randomInt32()}const o5=M5(h,`#version 300 es
  in vec4 aPosition;
  in vec2 aUV;
  out vec2 vUV;
  void main() {
    gl_Position = aPosition;
    vUV = aUV;
  }
  `,`#version 300 es
  precision highp float;
  precision highp isampler2D;
  uniform isampler2D uTex;
  in vec2 vUV;
  out vec4 finalColor;
  int fetchPixel(vec2 uv) {
    vec2 texSize = vec2(${n5}, ${a5});
    ivec4 color = texelFetch(uTex, ivec2(uv * texSize), 0);
    return color.r;
  }
  void main () {
    ivec2 texSize = textureSize(uTex, 0);
    finalColor = vec4(vec3(fetchPixel(vUV)) / 255.0, 1.0);
  }
  `,{}),Q=it({width:2,height:2}),mt=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,mt),h.bufferData(h.ARRAY_BUFFER,Q.interleavedArray,h.STATIC_DRAW);const S5=h.getAttribLocation(o5,"aPosition"),D5=h.getAttribLocation(o5,"aUV");h.vertexAttribPointer(S5,3,h.FLOAT,!1,Q.vertexStride*Float32Array.BYTES_PER_ELEMENT,0),h.vertexAttribPointer(D5,2,h.FLOAT,!1,Q.vertexStride*Float32Array.BYTES_PER_ELEMENT,3*Float32Array.BYTES_PER_ELEMENT);const pt=h.createBuffer();h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,pt),h.bufferData(h.ELEMENT_ARRAY_BUFFER,Q.indicesArray,h.STATIC_DRAW);const vt=h.getUniformLocation(o5,"uTex"),gt=h.createTexture();h.bindTexture(h.TEXTURE_2D,gt),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),h.useProgram(o5),h.uniform1i(vt,0),R.setSnakeMovementState(N),ft(),R.start(),I5.addEventListener("click",t=>{const e=t.target;e.nodeName==="BUTTON"&&e.dataset.action==="refresh"&&R.refreshGame()}),I5.addEventListener("click",t=>{const e=t.target;if(e.nodeName==="BUTTON"){const r=e.dataset.action;let i;switch(r){case"up":i=0;break;case"right":i=1;break;case"down":i=2;break;case"left":i=3;break;default:i=1}if(!H)return;H=!1,(N===0||N===2)&&(i===1||i===3)&&(N=i),(N===1||N===3)&&(i===0||i===2)&&(N=i),R.setSnakeMovementState(N)}}),document.body.addEventListener("keydown",t=>{let e;switch(t.key){case"1":t.preventDefault(),s5(1);break;case"2":t.preventDefault(),s5(2);break;case"3":t.preventDefault(),s5(3);break;case"R":case"r":t.preventDefault(),s5(2),R.refreshGame();break}switch(t.key){case"ArrowUp":t.preventDefault(),e=0;break;case"ArrowRight":t.preventDefault(),e=1;break;case"ArrowDown":t.preventDefault(),e=2;break;case"ArrowLeft":t.preventDefault(),e=3;break;default:return}H&&(H=!1,(N===0||N===2)&&(e===1||e===3)&&(N=e),(N===1||N===3)&&(e===0||e===2)&&(N=e),R.setSnakeMovementState(N))}),V=setInterval(h5,1e3/R5);function s5(t){t===1?(clearInterval(V),V=setInterval(h5,1e3/ct)):t===2?(clearInterval(V),V=setInterval(h5,1e3/R5)):t===3&&(clearInterval(V),V=setInterval(h5,1e3/lt)),R.setDifficulty(t)}function h5(){R.updateFrame(),h.texImage2D(h.TEXTURE_2D,0,h.R32I,n5,a5,0,h.RED_INTEGER,h.INT,ut),h.enableVertexAttribArray(S5),h.enableVertexAttribArray(D5),h.viewport(0,0,n5,a5),h.drawElements(h.TRIANGLES,Q.vertexCount,h.UNSIGNED_SHORT,0),H=!0}})();
